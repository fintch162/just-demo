// <script type="text/javascript">
//   $('#create_invoice').click(function(e){
//     getFromValues();
//     var f_arr = [];
//     $this = $(this);
//     $.ajax({
//       url: '/manage/message_templates/get_invoice_note',
//       type: 'get',
//       beforeSend: function() {
//         $this.html("Creating Invoice..");
//       }
//     })
//     .done(function(data) {
//       data = data.replace('[\"','');
//       data = data.replace('\"]','').split("---%---");
//       var invoice_note = String(data[0])
//       var view_pa = String(data[1])
      
//       for(var i=0; i<template_identifier.length; i++)
//       {
//         invoice_note = solidReplace(invoice_note, template_identifier[i], template_value[i]);
//         view_pa = solidReplace(view_pa, template_identifier[i], template_value[i]);
//       }
//       invoice_note = templateDecoder(invoice_note);
//       view_pa = templateDecoder(view_pa);
//       var api = "<%= @api_setting.fb_api_url %>";
//       e.preventDefault();
//       var job_id = "<%= @job.id %>"
//       $.ajax({
//         url: '/manage/create_invoice/'+job_id,
//         type: 'GET',
//         data: { invoice_info_body: invoice_note, view_pa: view_pa },
//         beforeSend: function() {
//           $this.html("Creating Invoice..");
//         }
//       })
//       .done(function(data) {
//         var url = 'https://'+api+'/updateInvoice?invoiceid='+data[1]
//         $("#after_create_inv_p").attr('href', url);
//         // window.open(url, "_blank")
//         // $("#after_create_inv_p").text(data[1]);
//         // $modal = $('.inv_det_modal'),
//         // $modal.modal();
//         $this.html("Create Invoice");
//       })
//       .fail(function(data) {
//         $modal = $('.invoice_err'),
//         $modal.modal();
//         $this.html("Create Invoice");
//       })
//     });
//   });
// </script>